# 百度地图 API 接入指南

## 1. 申请百度地图 API Key

### 1.1 注册账号
1. 访问 [百度地图开放平台](https://lbsyun.baidu.com/)
2. 点击右上角"控制台"
3. 使用百度账号登录（如果没有需要先注册）

### 1.2 创建应用
1. 进入控制台后，点击左侧菜单"应用管理" → "我的应用"
2. 点击"创建应用"按钮
3. 填写应用信息：
   - **应用名称**：智能共享单车管理系统
   - **应用类型**：选择"浏览器端"
   - **启用服务**：勾选 "JavaScript API v3.0"
   - **Referer白名单**：
     ```
     localhost:5173
     ```
     或者（多个域名，英文逗号分隔）：
     ```
     localhost:5173,127.0.0.1:5173
     ```
     或者（不限制，仅用于测试）：
     ```
     *
     ```
     ⚠️ **注意**：生产环境务必设置具体的域名，不要使用 `*`
4. 点击"提交"

### 1.3 获取 AK（访问密钥）
1. 创建成功后，在应用列表中可以看到刚创建的应用
2. 复制"访问应用(AK)"一栏的字符串
3. AK格式类似：`abcdefghijklmnopqrstuvwxyz123456`

## 2. 配置项目中使用 API Key

### 2.1 方式一：环境变量（推荐）
创建 `.env.local` 文件：
```bash
VITE_BAIDU_MAP_AK=你的AK密钥
```

### 2.2 方式二：直接配置
在 `src/config/mapConfig.js` 中配置：
```javascript
export const BAIDU_MAP_AK = '你的AK密钥';
```

## 3. 百度地图 JavaScript API 使用说明

### 3.1 在 HTML 中引入
在 `index.html` 的 `<head>` 中添加：
```html
<script src="https://api.map.baidu.com/api?v=3.0&ak=你的AK密钥"></script>
```

### 3.2 注意事项
1. **坐标系统**：百度地图使用 BD09 坐标系
2. **GPS转换**：如果你的数据是 WGS84（GPS原始坐标），需要转换为 BD09
3. **配额限制**：
   - 免费版：10,000 次/天
   - 超出后返回 `OVER_QPS` 错误

## 4. 常见问题

### Q1: 提示 "APP不存在，AK请检查"
- 检查 AK 是否正确复制（不要有空格）
- 检查 Referer 白名单格式是否正确
  - ✅ 正确格式：`localhost:5173`
  - ✅ 正确格式：`localhost:5173,127.0.0.1:5173`
  - ✅ 正确格式：`*.mysite.com`
  - ❌ 错误格式：`http://localhost:5173`（不要带协议）
  - ❌ 错误格式：`localhost:5173/`（不要带路径）
- 确认应用类型是"浏览器端"

### Q2: 地图显示空白
- 打开浏览器控制台查看错误信息
- 检查网络连接
- 确认 AK 类型是"浏览器端"而非"服务端"
- 确认当前访问地址在白名单中

### Q3: 坐标位置偏移
- 需要进行坐标转换（WGS84 → GCJ02 → BD09）
- 使用提供的坐标转换工具函数

## 5. 测试 AK 是否有效
创建测试页面访问：
```
https://api.map.baidu.com/api?v=3.0&ak=你的AK
```
如果返回一段 JavaScript 代码，说明 AK 有效。

---

**相关文档：**
- [百度地图 JavaScript API v3.0](https://lbsyun.baidu.com/index.php?title=jspopular3.0)
- [坐标转换说明](https://lbsyun.baidu.com/index.php?title=coordtrans)
